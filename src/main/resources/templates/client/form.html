<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head th:include="layout :: htmlhead"></head>
	<body topmargin=0 leftmargin=0>
		<div class="container">
			<nav th:replace="layout :: menu">(menu)</nav>
 			<div class="border border-dark">
				<form th:action="@{/client/(form)}" th:object="${client}" action="#" method="post">
					<input type="hidden" id="txtid" th:field="*{clientId}" />
				    <div>
                    	<h3>Informações pessoais do cliente</h3>
                    </div>
				    <div class="form-group">
				        <label for="txtname">Nome</label>
				        <input type="text" th:field="*{name}" class="form-control" 
				        id="txtname" placeholder="Digite o nome" pattern="[A-za-z]+$" required oninvalid="setCustomValidity('Por favor, preencha o nome')" 
				        onchange="try{setCustomValidity('')}catch(e){}">
				    </div>
				    <div class="form-group">
				        <label for="txtlastname">Sobrenome</label>
				        <input type="text" th:field="*{lastname}" class="form-control" 
				        id="txtlastname" placeholder="Digite o sobrenome" required>
				    </div>
				    <div class="form-group">
				        <label for="txtcpf">CPF</label>
				        <input type="text" th:field="*{cpf}" class="form-control" 
				        id="txtcpf" placeholder="Digite o CPF" required>
				    </div>
				    <div class="form-group">
				        <label for="txtemail">E-mail</label>
				        <input type="text" th:field="*{email}" class="form-control" 
				        id="txtemail" placeholder="Digite o e-mail" required>
				    </div> 
				    <div class="form-group">
				        <label for="txtphonenumber">Número de telefone</label>
				        <input type="text" th:field="*{phoneNumber}" class="form-control" 
				        id="txtphonenumber" placeholder="Digite o número de telefone" required>
				    </div> 
				    <div class="form-group">
				        <label for="txtpassword">Senha</label>
				        <input type="password" th:field="*{password}" class="form-control" 
				        id="txtpassword" placeholder="Digite a senha" required>
				    </div> 
				    <div class="form-group">
                        <label for="slcgenre">Sexo</label>
                        <select class="form-control" id="slcgenre" th:field="*{genre}" required>
                            <option th:value="M">Masculino</option>
                            <option th:value="F">Feminino</option>
                            <option th:value="O">Outro</option>
                        </select>
                    </div>
				    <div class="form-group">
                        <label for="txtDate">Data Nascimento</label>
                        <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
                            <input id = "birthDate" type="text" class="form-control datetimepicker-input" data-target="#datetimepicker1" 
                                th:field="*{birthDate}" required/>
                            <div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker">
                                <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="slcgenre">Status do cliente</label>
                        <select class="form-control" id="slcStatus" th:field="*{status}" required>
                            <option th:value="true">Ativo</option>
                            <option th:value="false">Inativo</option>
                        </select>
                    </div>
                    
                    <div>
                    <h3>Informações de endereço do cliente</h3>
                    </div>
                    
                    <div class="form-group">
				        <label for="txtcep">CEP</label>
				        <input type="text" th:field="*{adressCep}" class="form-control" 
				        id="txtcep" placeholder="Digite o CEP apenas com numeros ex: 89247392" required>
				    </div>
                    <div class="form-group">
				        <label for="txtstate">Estado</label>
				        <input type="text" th:field="*{adress_State}" class="form-control" 
				        id="txtstate" placeholder="Digite o estado" required>
				    </div>
				    <div class="form-group">
				        <label for="txtcity">Cidade</label>
				        <input type="text" th:field="*{adressCity}" class="form-control" 
				        id="txtcity" placeholder="Digite a cidade" required>
				    </div>
				    <div class="form-group">
				        <label for="txtneighborhood">Bairro</label>
				        <input type="text" th:field="*{adressNeighborhood}" class="form-control" 
				        id="txtneighborhood" placeholder="Digite a cidade" required>
				    </div>
				    <div class="form-group">
				        <label for="txtstreet">Rua</label>
				        <input type="text" th:field="*{adress_Street}" class="form-control" 
				        id="txtstreet" placeholder="Digite a cidade" required>
				    </div>
				    <div class="form-group">
				        <label for="txtnumber">Número</label>
				        <input type="text" th:field="*{adressNumber}" class="form-control" 
				        id="txtnumber" placeholder="Digite o número da residência" required>
				    </div>
				    <div class="form-group">
				        <label for="txtcomplement">Complemento</label>
				        <input type="text" th:field="*{adressComplement}" class="form-control" 
				        id="txtcomplement" placeholder="Digite o complemento do endereço" required>
				    </div>
				    <button type="submit" class="btn btn-primary">Enviar</button>
				</form>
			</div>
		</div>
		<div th:include="layout :: footer" id="footer">(footer)</div>
		   <script type="text/javascript">
            $(function () {
            	//Adiciona mascara para os campos
            	$("#txtcpf").mask("999.999.999-99");
            	$("#txtcep").mask("99999-999");
            	$("#txtphonenumber").mask("(99) 99999-9999");
                $('#datetimepicker1').datetimepicker({
                    format:"DD/MM/YYYY"                   
                });
                
            });
            
            $(document).ready(function() {

                function limpa_formulário_cep() {
                    // Limpa valores do formulário de cep.
                    $("#txtstreet").val("");
                    $("#txtneighborhood").val("");
                    $("#txtcity").val("");
                    $("#txtstate").val("");
                }
                
                //Quando o campo cep perde o foco.
                $("#txtcep").blur(function() {

                    //Nova variável "cep" somente com dígitos.
                    var cep = $(this).val().replace(/\D/g, '');

                    //Verifica se campo cep possui valor informado.
                    if (cep != "") {

                        //Expressão regular para validar o CEP.
                        var validacep = /^[0-9]{8}$/;

                        //Valida o formato do CEP.
                        if(validacep.test(cep)) {

                            //Preenche os campos com "..." enquanto consulta webservice.
                            $("#txtstreet").val("...");
                            $("#txtneighborhood").val("...");
                            $("#txtcity").val("...");
                            $("#txtstate").val("...");
                         

                            //Consulta o webservice viacep.com.br/
                            $.getJSON("https://viacep.com.br/ws/"+ cep +"/json/?callback=?", function(dados) {

                                if (!("erro" in dados)) {
                                    //Atualiza os campos com os valores da consulta.
                                    $("#txtstreet").val(dados.logradouro);
                                    $("#txtneighborhood").val(dados.bairro);
                                    $("#txtcity").val(dados.localidade);
                                    $("#txtstate").val(dados.uf);
                                } //end if.
                                else {
                                    //CEP pesquisado não foi encontrado.
                                    limpa_formulário_cep();
                                    alert("CEP não encontrado.");
                                }
                            });
                        } //end if.
                        else {
                            //cep é inválido.
                            limpa_formulário_cep();
                            alert("Formato de CEP inválido.");
                        }
                    } //end if.
                    else {
                        //cep sem valor, limpa formulário.
                        limpa_formulário_cep();
                    }
                });
            });
            
        </script>
	</body>
</html>